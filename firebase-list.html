<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../firebase-element/firebase-collection.html">
<link rel="import" href="../iron-list/iron-list.html">
<link rel="import" href="../firebase-card/firebase-card.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<!--
# firebase-list

`<firebase-list>` wraps the content of a firebase-collection into an iron-list

[API Docs and Demo](https://heka-house-firebase-list-demo.firebaseapp.com/)

[Source](http://github.com/hekahouse/firebase-list/)

## Install

    bower install --save HekaHouse/firebase-list

## Example

    <firebase-list
      firebase-root="https://YOUR-FIREBASE.firebaseio.com/YOUR-COLLECTION"
      collected="{{collected}}"
      route="[[route]]"
      path="ROUTING-PATH">
    </firebase-list>

In the above example replace YOUR-FIREBASE, YOUR-COLLECTION with appropriate values from your Firebase.

## Note

ROUTING-PATH should match the URL path used to access this element which triggers the Firebase collection to initialize.

## Dependencies

Element dependencies are managed via [Bower](http://bower.io/). You can
install that via:

    npm install -g bower

Then, go ahead and download the element's dependencies:

    bower install

firebase-list depends on

[firebase-card](https://heka-house-firebase-card-demo.firebaseapp.com/)

and

[firebase-input](https://heka-house-firebase-input-demo.firebaseapp.com/)

@group HekaHouse
@element firebase-list
@demo demo/index.html
@hero hero.svg
-->


<dom-module id="firebase-list">
  <template>
  <style>
    :host {
      display: block;
    }
    #listContainer {
      display: flex;
      flex-direction: column;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-content: stretch;
      width: 100%;
      min-height:400px;
      margin: 4px;
    }
  </style>
    <firebase-collection
      id="firebaseCollection"
      data="{{collected}}"></firebase-collection>

      <template is="dom-if" if="[[collected]]">
        <div class="fit">
          <iron-list id="listContainer" class="fit" items="{{collected}}" as="doc">
              <template>
                <firebase-card
                  firebase-root="{{firebaseRoot}}"
                  document-key="{{doc.__firebaseKey__}}">
                </firebase-card>
              </template>
          </iron-list>
        </div>
      </template>
  </template>
</dom-module>
<script>

  Polymer({
    is: 'firebase-list',

    properties: {
      /**
      * URL to firebase collection
      */
      firebaseRoot: {
        type: String,
        notify: true
      },
      /**
      * URL Path that is currently active
      * Triggers Firebase initialization
      */
      route: {
        type: String,
        notify: true,
        observer: '_routed'
      },
      /**
      * Expected URL path that will display this element
      * Triggers Firebase initialization
      */
      path: {
        type: String,
        notify: true,
        observer: '_routed'
      },
      /**
     * Firebase Collection items
     * @type {{elements: Array<FirebaseDocument>}}
     */
      collected: {
        type: Array,
        notify: true
      }
    },
    /**
    * Called when both path and route are set
    * If both have been set along with the firebase url,
    * applies firebasse url to firebase-collection.location
    */
    _routed: function(routing) {
      if (this.route === this.path && this.firebaseRoot) {
        this.$.firebaseCollection.location = this.firebaseRoot;
      }
    }
  });
</script>
